<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>shared&#x2F;model&#x2F;hp-pool.js - Eve Ship Comparator API</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="Eve Ship Comparator API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/esc.Capacitor.html">esc.Capacitor</a></li>
            
                <li><a href="..&#x2F;classes/esc.Capacity.html">esc.Capacity</a></li>
            
                <li><a href="..&#x2F;classes/esc.Criteria.html">esc.Criteria</a></li>
            
                <li><a href="..&#x2F;classes/esc.DamageProfile.html">esc.DamageProfile</a></li>
            
                <li><a href="..&#x2F;classes/esc.Database.html">esc.Database</a></li>
            
                <li><a href="..&#x2F;classes/esc.Drones.html">esc.Drones</a></li>
            
                <li><a href="..&#x2F;classes/esc.Heat.html">esc.Heat</a></li>
            
                <li><a href="..&#x2F;classes/esc.HpPool.html">esc.HpPool</a></li>
            
                <li><a href="..&#x2F;classes/esc.JumpDrive.html">esc.JumpDrive</a></li>
            
                <li><a href="..&#x2F;classes/esc.MicroTemplate.html">esc.MicroTemplate</a></li>
            
                <li><a href="..&#x2F;classes/esc.Promise.html">esc.Promise</a></li>
            
                <li><a href="..&#x2F;classes/esc.Promise.Resolver.html">esc.Promise.Resolver</a></li>
            
                <li><a href="..&#x2F;classes/esc.Query.html">esc.Query</a></li>
            
                <li><a href="..&#x2F;classes/esc.Select.html">esc.Select</a></li>
            
                <li><a href="..&#x2F;classes/esc.Sensors.html">esc.Sensors</a></li>
            
                <li><a href="..&#x2F;classes/esc.Shield.html">esc.Shield</a></li>
            
                <li><a href="..&#x2F;classes/esc.Ship.html">esc.Ship</a></li>
            
                <li><a href="..&#x2F;classes/esc.Skill.html">esc.Skill</a></li>
            
                <li><a href="..&#x2F;classes/esc.SkillRequirement.html">esc.SkillRequirement</a></li>
            
                <li><a href="..&#x2F;classes/esc.SkillRequirements.html">esc.SkillRequirements</a></li>
            
                <li><a href="..&#x2F;classes/esc.Slots.html">esc.Slots</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/esc-hp-pool.html">esc-hp-pool</a></li>
            
                <li><a href="..&#x2F;modules/esc-micro-template.html">esc-micro-template</a></li>
            
                <li><a href="..&#x2F;modules/esc-promise.html">esc-promise</a></li>
            
                <li><a href="..&#x2F;modules/esc-select.html">esc-select</a></li>
            
                <li><a href="..&#x2F;modules/esc-ship.html">esc-ship</a></li>
            
                <li><a href="..&#x2F;modules/esc-ship-properties.html">esc-ship-properties</a></li>
            
                <li><a href="..&#x2F;modules/esc-skill.html">esc-skill</a></li>
            
                <li><a href="..&#x2F;modules/esc-sqlite.html">esc-sqlite</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: shared&#x2F;model&#x2F;hp-pool.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;*global YUI*&#x2F;
&#x2F;**
 Objects, classes, and methods related to hit point pools for ships in Eve Online. Includes calculating EHP based on a number of strategies (EFT, and CCP&#x27;s own calculations) and different damage profiles (Gursita, Amarr, Serpentis, etc.).

 @module esc-hp-pool
 @namespace esc
 **&#x2F;
YUI.add(&#x27;esc-hp-pool&#x27;, function (Y) {
    &quot;use strict&quot;;

    var NS = Y.namespace(&#x27;esc&#x27;);

&#x2F;&#x2F;
&#x2F;&#x2F; --- Damage Profile -------------------------------------------------------
&#x2F;&#x2F;

    &#x2F;**
     A utility class that generates an EHP based on a provided HpPool instance.

     @class DamageProfile
     @constructor
     @param cfg {Object} A configuration object that accepts the following properties:

     * **em** - The proportion of EM damage.
     * **explosive** - The proportion of explosive damage.
     * **kinetic** - The proportion of kinetic damage.
     * **thermal** - The proportion of thermal damage.

     If the sum of all four damage levels is greater than 1, they will all be normalized in relation to each other to enforce a total value of 1.

     For example, passing &#x60;{ em: 1, explosive: 1, kinetic: 1, thermal: 1 }&#x60; will normalize each value to &#x60;0.25&#x60;.

     The damage profiles defined as static properties on this object are taken from this site:
     &lt;http:&#x2F;&#x2F;eve-survival.org&#x2F;wikka.php?wakka=TankingGuide&gt;

     **&#x2F;
    function DamageProfile(cfg) {
        cfg = Y.merge({ em : 0, explosive : 0, kinetic : 0, thermal : 0 }, cfg);

        var coeff = 1 &#x2F; (cfg.em + cfg.explosive + cfg.kinetic + cfg.thermal);

        coeff = isFinite(coeff) ? coeff : 1;

        this.em = cfg.em * coeff;
        this.explosive = cfg.explosive * coeff;
        this.kinetic = cfg.kinetic * coeff;
        this.thermal = cfg.thermal * coeff;
    }

    Y.mix(DamageProfile.prototype, {
        &#x2F;**
         @property em {Number}
         @default 0
         **&#x2F;
        em : 0,

        &#x2F;**
         @property explosive {Number}
         @default 0
         **&#x2F;
        explosive : 0,

        &#x2F;**
         @property kinetic {Number}
         @default 0
         **&#x2F;
        kinetic : 0,

        &#x2F;**
         @property thermal {Number}
         @default 0
         **&#x2F;
        thermal : 0,

        &#x2F;**
         @method ehp
         @param hpPool {HpPool} An HpPool instance to generate an EHP value from.
         @return {Number} The EHP of that hit point pool.
         **&#x2F;
        ehp : function (hpPool) {
            var resistance = hpPool.emResistance * this.em +
                hpPool.explosiveResistance * this.explosive +
                hpPool.kineticResistance * this.kinetic +
                hpPool.thermalResistance * this.thermal;

            return hpPool.hp &#x2F; (1 - resistance);
        }
    });

&#x2F;&#x2F;
&#x2F;&#x2F; --- Damage constants -------------------------------------------------
&#x2F;&#x2F;
&#x2F;&#x2F;
&#x2F;&#x2F;

    &#x2F;**
     The standard even-distribution profile used by EFT.

     @property eft {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.eft = new DamageProfile({ em : 1, explosive : 1, kinetic : 1, thermal : 1 });

    &#x2F;**
     The Gurista damage profile.

     @property gurista {esc.DamageProfile}
     @static
     **&#x2F;
    &#x2F;**
     The EOM damage profile.

     @property eom {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.gurista =
        DamageProfile.eom = new DamageProfile({ kinetic : 0.75, thermal : 0.25 });

    &#x2F;**
     The Angel Cartell damage profile.

     @property angel {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.angel = new DamageProfile({ kinetic : 0.75, thermal : 0.25 });

    &#x2F;**
     The Sanshas Nation damage profile.

     @property sansha {esc.DamageProfile}
     @static
     **&#x2F;
    &#x2F;**
     The Blood Raider Covenant damage profile.

     @property bloodRaider {esc.DamageProfile}
     @static
     **&#x2F;
    &#x2F;**
     The Amarr Empire damage profile.

     @property amarr {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.sansha =
        DamageProfile.bloodRaider =
            DamageProfile.amarr = new DamageProfile({ em : 0.5, thermal : 0.5 });

    &#x2F;**
     The Serpentis damage profile.

     @property serpentis {esc.DamageProfile}
     @static
     **&#x2F;
    &#x2F;**
     The Caldari damage profile.

     @property caldari {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.serpentis =
        DamageProfile.caldari = new DamageProfile({ kinetic : 0.5, thermal : 0.5 });

    &#x2F;**
     The Gallente Federation damage profile.

     @property gallente {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.gallente = new DamageProfile({ kinetic : 0.5, thermal : 0.4, em : 0.1 });

    &#x2F;**
     The Minmatar damage profile.

     @property minmatar {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.minmatar = new DamageProfile({ explosive : 0.5, em : 0.2, kinetic : 0.2, thermal : 0.1 });

    &#x2F;**
     The Mercenaries (?) damage profile.

     @property mercenaries {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.mercenaries = new DamageProfile({ thermal : 0.5, kinetic : 0.3, explosive : 0.1, em : 0.1 });

    &#x2F;**
     The Rogue Drone damage profile.

     @property drones {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.drones = new DamageProfile({ explosive : 0.7, kinetic : 0.2, thermal : 0.1 });

    &#x2F;**
     The damage profile used by the in-game fitting tool. CCP uses a different strategy, they use the weakest of a pool&#x27;s four resists to generate the EHP.

     @property eve {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.eve = (function () {
        var eveDamageProfile = new DamageProfile();

        eveDamageProfile.ehp = function (h) {
            var minResist = Math.min(h.emResistance, h.explosiveResistance, h.kineticResistance, h.thermalResistance);
            return h.hp &#x2F; (1 - minResist);
        };

        return eveDamageProfile;
    }());

    &#x2F;**
     HpPools will fall back to this damage profile if no damageProfile is provided to the instance. Defaults to the EFT profile.

     @property sharedDamageProfile {esc.DamageProfile}
     @static
     **&#x2F;
    DamageProfile.sharedDamageProfile = DamageProfile.eft;

    NS.DamageProfile = DamageProfile;

&#x2F;&#x2F;
&#x2F;&#x2F; --- HP Pool --------------------------------------------------------------
&#x2F;&#x2F;

    function getResistanceFn(type) {
        return function () {
            return 1 - this[type + &#x27;Resonance&#x27;];
        };
    }

    &#x2F;**
     Represents one of the three HP &#x27;pools&#x27; on a ship: shields, armor, and structure (hull)

     @class HpPool
     @constructor
     **&#x2F;
    function HpPool(cfg) {
        Y.mix(this, cfg || {}, true, Object.keys(HpPool.prototype));
    }

    Y.mix(HpPool.prototype, {
        &#x2F;**
         @property hp {Number}
         **&#x2F;
        hp : 0,

        &#x2F;**
         @property emResonance {Number}
         **&#x2F;
        emResonance : 0,

        &#x2F;**
         @property explosiveResonance {Number}
         **&#x2F;
        explosiveResonance : 0,

        &#x2F;**
         @property kineticResonance {Number}
         **&#x2F;
        kineticResonance : 0,

        &#x2F;**
         @property thermalResonance {Number}
         **&#x2F;
        thermalResonance : 0,

        &#x2F;**
         @property damageProfile {esc.DamageProfile}
         @default null
         **&#x2F;
        damageProfile : null
    });

    &#x2F;*
     HP pool resonances appear to be the inverse of that pool&#x27;s resistances. Resistances aren&#x27;t saved in the dataset I&#x27;m using, so I&#x27;m using an ECMA5 getter to generate that data as needed.
     *&#x2F;
    Object.defineProperties(HpPool.prototype, {
        &#x2F;**
         @property emResistance {Number}
         @readOnly
         **&#x2F;
        emResistance : { writeable : false, get : getResistanceFn(&#x27;em&#x27;) },

        &#x2F;**
         @property explosiveResistance {Number}
         @readOnly
         **&#x2F;
        explosiveResistance : { writeable : false, get : getResistanceFn(&#x27;explosive&#x27;) },

        &#x2F;**
         @property kineticResistance {Number}
         @readOnly
         **&#x2F;
        kineticResistance : { writeable : false, get : getResistanceFn(&#x27;kinetic&#x27;)   },

        &#x2F;**
         @property thermalResistance {Number}
         @readOnly
         **&#x2F;
        thermalResistance : { writeable : false, get : getResistanceFn(&#x27;thermal&#x27;)   },

        &#x2F;**
         The effective hit points of this damage pool, typically calculated by:

         &#x60;EHP = HP &#x2F; (1-RST)&#x60;

         Where &#x27;HP&#x60; is the pool size and &#x60;RST&#x60; is the average damage resistance against the four damage types.

         Source: &lt;http:&#x2F;&#x2F;community.eveonline.com&#x2F;ingameboard.asp?a=topic&amp;threadID=780756&gt;

         @property ehp {Number}
         @readOnly
         **&#x2F;
        ehp : {
            writeable : false,
            get       : function () {
                var profile = this.damageProfile || DamageProfile.sharedDamageProfile;
                return profile.ehp(this);
            }
        }
    });

    NS.HpPool = HpPool;

&#x2F;&#x2F;
&#x2F;&#x2F; --- Shield ---------------------------------------------------------------
&#x2F;&#x2F;


    &#x2F;**
     A descendant of the HpPool object that has additional features related to shield rechage rates.

     @class Shield
     @constructor
     @extends esc.HpPool
     **&#x2F;
    function Shield(cfg) {
        Shield.superclass.constructor.apply(this, arguments);

        Y.mix(this, cfg || {}, true, Object.keys(Shield.prototype));
    }

    Y.extend(Shield, HpPool, {
        &#x2F;**
         The amount of time it takes for the shield to go from fully discharged to fully charged in seconds.
         @property recharge {Number}
         **&#x2F;
        recharge: 0
    });


    &#x2F;**
     The peak recharge rate of a shield is defined by:

     &#x60;R = 2.4 * S &#x2F; R&#x60;

     Where &#x60;R&#x60; is the recharge rate, &#x60;S&#x60; is the maximum shield size, and &#x60;R&#x60; is the recharge rate in seconds.

     Source: &lt;http:&#x2F;&#x2F;wiki.eveonline.com&#x2F;en&#x2F;wiki&#x2F;Shield_recharge&gt;

     @property peakRecharge {Number}
     @readOnly
    **&#x2F;
    Object.defineProperty(Shield.prototype, &#x27;peakRecharge&#x27;, {
        writeable : false,
        get       : function () { return this.hp * 2.4 &#x2F; (this.recharge &#x2F; 1000); }
    });

    NS.Shield = Shield;

}, &#x27;&#x27;, {
    requires: [ &#x27;oop&#x27; ]
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
